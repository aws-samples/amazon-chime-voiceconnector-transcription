apply plugin: 'java'

archivesBaseName = 'amazon-chime-voiceconnector-recordandtranscribe'
repositories {
    mavenCentral()
}

dependencies {
    compile group: 'io.reactivex.rxjava2', name: 'rxjava', version: '2.2.2'
    compile(
            'software.amazon.awssdk:transcribestreaming:2.2.0',

            'com.amazonaws:aws-java-sdk-dynamodb:1.11.475',
            'com.amazonaws:aws-java-sdk-kinesisvideo:1.11.475',
            'com.amazonaws:aws-lambda-java-core:1.2.0',
            'com.amazonaws:aws-lambda-java-events:2.2.6',
            'com.amazonaws:aws-java-sdk-cloudwatch:1.11.592',
            'com.amazonaws:amazon-kinesis-video-streams-parser-library:1.0.13',
            'org.slf4j:slf4j-api:1.7.24',
            'org.slf4j:slf4j-log4j12:1.7.24',

            // need this for our async clients
            'software.amazon.awssdk:netty-nio-client:2.2.0',

            // need this for logging
            'org.apache.commons:commons-lang3:3.6',

            // need for argument parsing
            'commons-cli:commons-cli:1.4'
    )
}

task buildZip(type: Zip) {
    from compileJava
    from processResources

    into('lib') {
        from configurations.compileClasspath
    }
}

task copyCFTemplate(type: Copy){
    from "infrastructure/deployment-template.json"
    into "$buildDir/distributions"
}

build.dependsOn buildZip, copyCFTemplate
